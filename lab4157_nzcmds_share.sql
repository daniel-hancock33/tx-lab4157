-- 01

CREATE TABLE "DB4157_SHARE"."U4157"."CUSTOMER" as SELECT * FROM "DB4157"."ADMIN"."CUSTOMER";
CREATE TABLE "DB4157_SHARE"."U4157"."LINEITEM" as SELECT * FROM "DB4157"."ADMIN"."LINEITEM";
CREATE TABLE "DB4157_SHARE"."U4157"."NATION" as SELECT * FROM "DB4157"."ADMIN"."NATION";
CREATE TABLE "DB4157_SHARE"."U4157"."ORDERS" as SELECT * FROM "DB4157"."ADMIN"."ORDERS";
CREATE TABLE "DB4157_SHARE"."U4157"."PART"  as SELECT * FROM "DB4157"."ADMIN"."PART";
CREATE TABLE "DB4157_SHARE"."U4157"."PARTSUPP" as SELECT * FROM "DB4157"."ADMIN"."PARTSUPP";
CREATE TABLE "DB4157_SHARE"."U4157"."REGION" as SELECT * FROM "DB4157"."ADMIN"."REGION";
CREATE TABLE "DB4157_SHARE"."U4157"."SUPPLIER" as SELECT * FROM "DB4157"."ADMIN"."SUPPLIER";


--- 02

CREATE TABLE "DB4157_SHARE"."U4157"."LINEITEM_ARCHIVE" as 
SELECT * FROM "DB4157_SHARE"."U4157"."LINEITEM" 
WHERE DATE_PART('YEAR', "L_RECEIPTDATE") < 2020;

CREATE TABLE "DB4157_SHARE"."U4157"."ORDERS_ARCHIVE" as 
SELECT * FROM "DB4157_SHARE"."U4157"."ORDERS" 
WHERE DATE_PART('YEAR', "O_ORDERDATE") < 2020;

--- 03

DELETE FROM "DB4157_SHARE"."U4157"."LINEITEM" 
WHERE DATE_PART('YEAR', "L_RECEIPTDATE") < 2020;

DELETE FROM "DB4157_SHARE"."U4157"."ORDERS"
WHERE DATE_PART('YEAR', "O_ORDERDATE") < 2020;